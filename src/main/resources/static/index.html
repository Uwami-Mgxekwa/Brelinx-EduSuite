<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brelinx EduSuite - Student Management System</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Brelinx EduSuite</h1>
            <p>Student Management System</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showTab('schools')">Schools</button>
            <button class="nav-tab" onclick="showTab('students')">Students</button>
            <button class="nav-tab" onclick="showTab('teachers')">Teachers</button>
            <button class="nav-tab" onclick="showTab('courses')">Courses</button>
            <button class="nav-tab" onclick="showTab('grades')">Grades</button>
            <button class="nav-tab" onclick="showTab('attendance')">Attendance</button>
            <button class="nav-tab" onclick="showTab('api')">API Testing</button>
        </div>
        
        <div class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="schoolCount">-</div>
                        <div class="stat-label">Schools</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="studentCount">-</div>
                        <div class="stat-label">Students</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="teacherCount">-</div>
                        <div class="stat-label">Teachers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="courseCount">-</div>
                        <div class="stat-label">Courses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="gradeCount">-</div>
                        <div class="stat-label">Grades</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">‚úÖ</div>
                        <div class="stat-label">System Status</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üöÄ Welcome to Brelinx EduSuite!</h3>
                    <p>This is your Student Management System dashboard. Here you can:</p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>Manage schools and their information</li>
                        <li>Add and track students</li>
                        <li>View and manage courses</li>
                        <li>Access the H2 database console</li>
                        <li>Test API endpoints</li>
                    </ul>
                    <button class="btn" onclick="loadDashboardData()">üîÑ Refresh Data</button>
                    <button class="btn" onclick="window.open('/swagger-ui.html', '_blank')">üìö API Docs</button>
                    <button class="btn" onclick="showMongoInfo()">üçÉ MongoDB Info</button>
                </div>
            </div>
            
            <!-- Schools Tab -->
            <div id="schools" class="tab-content">
                <div class="card">
                    <h3>üè´ School Management</h3>
                    <button class="btn" onclick="loadSchools()">üìã Load All Schools</button>
                    <button class="btn" onclick="showAddSchoolForm()">‚ûï Add New School</button>
                    
                    <div id="addSchoolForm" class="form-container">
                        <h4>Add New School</h4>
                        <div class="form-group">
                            <label>School Name:</label>
                            <input type="text" id="schoolName" placeholder="Enter school name">
                        </div>
                        <div class="form-group">
                            <label>Address:</label>
                            <input type="text" id="schoolAddress" placeholder="Enter school address">
                        </div>
                        <div class="form-group">
                            <label>Contact:</label>
                            <input type="text" id="schoolContact" placeholder="Enter contact information">
                        </div>
                        <button class="btn" onclick="addSchool()">üíæ Save School</button>
                        <button class="btn btn-secondary" onclick="hideAddSchoolForm()">‚ùå Cancel</button>
                    </div>
                    
                    <div id="schoolsData" class="data-display"></div>
                </div>
            </div>
            
            <!-- Students Tab -->
            <div id="students" class="tab-content">
                <div class="card">
                    <h3>üë®‚Äçüéì Student Management</h3>
                    <button class="btn" onclick="loadStudents()">üìã Load All Students</button>
                    <button class="btn" onclick="showAddStudentForm()">‚ûï Add New Student</button>
                    
                    <div id="addStudentForm" class="form-container">
                        <h4>Add New Student</h4>
                        <div class="form-group">
                            <label>First Name:</label>
                            <input type="text" id="studentFirstName" placeholder="Enter first name">
                        </div>
                        <div class="form-group">
                            <label>Last Name:</label>
                            <input type="text" id="studentLastName" placeholder="Enter last name">
                        </div>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="studentEmail" placeholder="Enter email address">
                        </div>
                        <div class="form-group">
                            <label>Student ID:</label>
                            <input type="text" id="studentId" placeholder="Enter student ID">
                        </div>
                        <button class="btn" onclick="addStudent()">üíæ Save Student</button>
                        <button class="btn btn-secondary" onclick="hideAddStudentForm()">‚ùå Cancel</button>
                    </div>
                    
                    <div id="studentsData" class="data-display"></div>
                </div>
            </div>
            
            <!-- Teachers Tab -->
            <div id="teachers" class="tab-content">
                <div class="card">
                    <h3>üë®‚Äçüè´ Teacher Management</h3>
                    <button class="btn" onclick="loadTeachers()">üìã Load All Teachers</button>
                    <button class="btn" onclick="showAddTeacherForm()">‚ûï Add New Teacher</button>
                    
                    <div id="addTeacherForm" class="form-container">
                        <h4>Add New Teacher</h4>
                        <div class="form-group">
                            <label>First Name:</label>
                            <input type="text" id="teacherFirstName" placeholder="Enter first name">
                        </div>
                        <div class="form-group">
                            <label>Last Name:</label>
                            <input type="text" id="teacherLastName" placeholder="Enter last name">
                        </div>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="teacherEmail" placeholder="Enter email address">
                        </div>
                        <div class="form-group">
                            <label>Employee ID:</label>
                            <input type="text" id="teacherEmployeeId" placeholder="Enter employee ID">
                        </div>
                        <div class="form-group">
                            <label>Department:</label>
                            <input type="text" id="teacherDepartment" placeholder="Enter department">
                        </div>
                        <div class="form-group">
                            <label>Phone Number:</label>
                            <input type="text" id="teacherPhone" placeholder="Enter phone number">
                        </div>
                        <button class="btn" onclick="addTeacher()">üíæ Save Teacher</button>
                        <button class="btn btn-secondary" onclick="hideAddTeacherForm()">‚ùå Cancel</button>
                    </div>
                    
                    <div id="teachersData" class="data-display"></div>
                </div>
            </div>
            
            <!-- Courses Tab -->
            <div id="courses" class="tab-content">
                <div class="card">
                    <h3>üìö Course Management</h3>
                    <button class="btn" onclick="loadCourses()">üìã Load All Courses</button>
                    <button class="btn" onclick="showAddCourseForm()">‚ûï Add New Course</button>
                    
                    <div id="addCourseForm" class="form-container">
                        <h4>Add New Course</h4>
                        <div class="form-group">
                            <label>Course Name:</label>
                            <input type="text" id="courseName" placeholder="Enter course name">
                        </div>
                        <div class="form-group">
                            <label>Course Code:</label>
                            <input type="text" id="courseCode" placeholder="Enter course code">
                        </div>
                        <div class="form-group">
                            <label>Description:</label>
                            <input type="text" id="courseDescription" placeholder="Enter course description">
                        </div>
                        <div class="form-group">
                            <label>Credits:</label>
                            <input type="number" id="courseCredits" placeholder="Enter credits">
                        </div>
                        <button class="btn" onclick="addCourse()">üíæ Save Course</button>
                        <button class="btn btn-secondary" onclick="hideAddCourseForm()">‚ùå Cancel</button>
                    </div>
                    
                    <div id="coursesData" class="data-display"></div>
                </div>
            </div>
            
            <!-- Grades Tab -->
            <div id="grades" class="tab-content">
                <div class="card">
                    <h3>üìä Grade Management</h3>
                    <button class="btn" onclick="loadGrades()">üìã Load All Grades</button>
                    <button class="btn" onclick="showAddGradeForm()">‚ûï Add New Grade</button>
                    
                    <div id="addGradeForm" class="form-container">
                        <h4>Add New Grade</h4>
                        <div class="form-group">
                            <label>Assignment Name:</label>
                            <input type="text" id="gradeAssignmentName" placeholder="Enter assignment name">
                        </div>
                        <div class="form-group">
                            <label>Assignment Type:</label>
                            <select id="gradeAssignmentType">
                                <option value="EXAM">Exam</option>
                                <option value="QUIZ">Quiz</option>
                                <option value="HOMEWORK">Homework</option>
                                <option value="PROJECT">Project</option>
                                <option value="LAB">Lab</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Score:</label>
                            <input type="number" id="gradeScore" placeholder="Enter score" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>Max Score:</label>
                            <input type="number" id="gradeMaxScore" placeholder="Enter max score" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>Comments:</label>
                            <input type="text" id="gradeComments" placeholder="Enter comments">
                        </div>
                        <button class="btn" onclick="addGrade()">üíæ Save Grade</button>
                        <button class="btn btn-secondary" onclick="hideAddGradeForm()">‚ùå Cancel</button>
                    </div>
                    
                    <div id="gradesData" class="data-display"></div>
                </div>
            </div>
            
            <!-- Attendance Tab -->
            <div id="attendance" class="tab-content">
                <div class="card">
                    <h3>üìÖ Attendance Management</h3>
                    <button class="btn" onclick="loadAttendance()">üìã Load All Attendance</button>
                    <button class="btn" onclick="showAddAttendanceForm()">‚ûï Record Attendance</button>
                    <button class="btn" onclick="quickCheckIn()">‚ö° Quick Check-In</button>
                    
                    <div id="addAttendanceForm" class="form-container">
                        <h4>Record Attendance</h4>
                        <div class="form-group">
                            <label>Date:</label>
                            <input type="date" id="attendanceDate">
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select id="attendanceStatus">
                                <option value="PRESENT">Present</option>
                                <option value="ABSENT">Absent</option>
                                <option value="LATE">Late</option>
                                <option value="EXCUSED">Excused</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Notes:</label>
                            <input type="text" id="attendanceNotes" placeholder="Enter notes">
                        </div>
                        <button class="btn" onclick="addAttendance()">üíæ Save Attendance</button>
                        <button class="btn btn-secondary" onclick="hideAddAttendanceForm()">‚ùå Cancel</button>
                    </div>
                    
                    <div id="attendanceData" class="data-display"></div>
                </div>
            </div>

            <!-- API Testing Tab -->
            <div id="api" class="tab-content">
                <div class="card">
                    <h3>üîß API Testing</h3>
                    <p>Test the REST API endpoints directly:</p>
                    
                    <div style="margin: 20px 0;">
                        <h4>Available Endpoints:</h4>
                        <button class="btn" onclick="testEndpoint('/api/schools', 'GET')">GET /api/schools</button>
                        <button class="btn" onclick="testEndpoint('/api/students', 'GET')">GET /api/students</button>
                        <button class="btn" onclick="testEndpoint('/api/teachers', 'GET')">GET /api/teachers</button>
                        <button class="btn" onclick="testEndpoint('/api/courses', 'GET')">GET /api/courses</button>
                        <button class="btn" onclick="testEndpoint('/api/grades', 'GET')">GET /api/grades</button>
                        <button class="btn" onclick="testEndpoint('/api/attendance', 'GET')">GET /api/attendance</button>
                        <button class="btn" onclick="testEndpoint('/api/dashboard/stats', 'GET')">GET /api/dashboard/stats</button>
                        <button class="btn" onclick="testEndpoint('/api/dashboard/analytics', 'GET')">GET /api/dashboard/analytics</button>
                    </div>
                    
                    <div id="apiResults" class="data-display"></div>
                </div>
            </div>""
        </div>
    </div>

    <script>
        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // API functions
        async function apiCall(endpoint, method = 'GET', data = null) {
            try {
                const options = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };
                
                if (data) {
                    options.body = JSON.stringify(data);
                }
                
                const response = await fetch(endpoint, options);
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                return { error: error.message };
            }
        }
        
        // Dashboard functions
        async function loadDashboardData() {
            try {
                const stats = await apiCall('/api/dashboard/stats');
                
                if (stats && !stats.error) {
                    document.getElementById('schoolCount').textContent = stats.totalSchools || '0';
                    document.getElementById('studentCount').textContent = stats.totalStudents || '0';
                    document.getElementById('teacherCount').textContent = stats.totalTeachers || '0';
                    document.getElementById('courseCount').textContent = stats.totalCourses || '0';
                    document.getElementById('gradeCount').textContent = stats.totalGrades || '0';
                } else {
                    // Fallback to individual API calls
                    const schools = await apiCall('/api/schools');
                    const students = await apiCall('/api/students');
                    const teachers = await apiCall('/api/teachers');
                    const courses = await apiCall('/api/courses');
                    const grades = await apiCall('/api/grades');
                    
                    document.getElementById('schoolCount').textContent = Array.isArray(schools) ? schools.length : '0';
                    document.getElementById('studentCount').textContent = Array.isArray(students) ? students.length : '0';
                    document.getElementById('teacherCount').textContent = Array.isArray(teachers) ? teachers.length : '0';
                    document.getElementById('courseCount').textContent = Array.isArray(courses) ? courses.length : '0';
                    document.getElementById('gradeCount').textContent = Array.isArray(grades) ? grades.length : '0';
                }
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }
        
        // School functions
        async function loadSchools() {
            const data = await apiCall('/api/schools');
            displayData('schoolsData', data, 'Schools');
        }
        
        function showAddSchoolForm() {
            document.getElementById('addSchoolForm').style.display = 'block';
        }
        
        function hideAddSchoolForm() {
            document.getElementById('addSchoolForm').style.display = 'none';
        }
        
        async function addSchool() {
            const schoolData = {
                name: document.getElementById('schoolName').value,
                address: document.getElementById('schoolAddress').value,
                contact: document.getElementById('schoolContact').value
            };
            
            const result = await apiCall('/api/schools', 'POST', schoolData);
            displayMessage('schoolsData', result, 'success');
            hideAddSchoolForm();
            loadSchools();
        }
        
        // Student functions
        async function loadStudents() {
            const data = await apiCall('/api/students');
            displayData('studentsData', data, 'Students');
        }
        
        function showAddStudentForm() {
            document.getElementById('addStudentForm').style.display = 'block';
        }
        
        function hideAddStudentForm() {
            document.getElementById('addStudentForm').style.display = 'none';
        }
        
        async function addStudent() {
            const studentData = {
                firstName: document.getElementById('studentFirstName').value,
                lastName: document.getElementById('studentLastName').value,
                email: document.getElementById('studentEmail').value,
                studentId: document.getElementById('studentId').value
            };
            
            const result = await apiCall('/api/students', 'POST', studentData);
            displayMessage('studentsData', result, 'success');
            hideAddStudentForm();
            loadStudents();
        }
        
        // API Testing functions
        async function testEndpoint(endpoint, method) {
            const result = await apiCall(endpoint, method);
            displayData('apiResults', result, `${method} ${endpoint}`);
        }
        
        // Utility functions
        function displayData(elementId, data, title) {
            const element = document.getElementById(elementId);
            element.innerHTML = `
                <h4>${title} Results:</h4>
                <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto;">${JSON.stringify(data, null, 2)}</pre>
            `;
        }
        
        function displayMessage(elementId, message, type) {
            const element = document.getElementById(elementId);
            const className = type === 'success' ? 'success' : 'error';
            element.innerHTML = `<div class="${className}">${typeof message === 'string' ? message : JSON.stringify(message)}</div>`;
        }
        
        // Teacher functions
        async function loadTeachers() {
            const data = await apiCall('/api/teachers');
            displayData('teachersData', data, 'Teachers');
        }
        
        function showAddTeacherForm() {
            document.getElementById('addTeacherForm').style.display = 'block';
        }
        
        function hideAddTeacherForm() {
            document.getElementById('addTeacherForm').style.display = 'none';
        }
        
        async function addTeacher() {
            const teacherData = {
                firstName: document.getElementById('teacherFirstName').value,
                lastName: document.getElementById('teacherLastName').value,
                email: document.getElementById('teacherEmail').value,
                employeeId: document.getElementById('teacherEmployeeId').value,
                department: document.getElementById('teacherDepartment').value,
                phoneNumber: document.getElementById('teacherPhone').value,
                hireDate: new Date().toISOString().split('T')[0]
            };
            
            const result = await apiCall('/api/teachers', 'POST', teacherData);
            displayMessage('teachersData', result, 'success');
            hideAddTeacherForm();
            loadTeachers();
        }
        
        // Course functions
        async function loadCourses() {
            const data = await apiCall('/api/courses');
            displayData('coursesData', data, 'Courses');
        }
        
        function showAddCourseForm() {
            document.getElementById('addCourseForm').style.display = 'block';
        }
        
        function hideAddCourseForm() {
            document.getElementById('addCourseForm').style.display = 'none';
        }
        
        async function addCourse() {
            const courseData = {
                name: document.getElementById('courseName').value,
                courseCode: document.getElementById('courseCode').value,
                description: document.getElementById('courseDescription').value,
                credits: parseInt(document.getElementById('courseCredits').value),
                startDate: new Date().toISOString().split('T')[0],
                endDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]
            };
            
            const result = await apiCall('/api/courses', 'POST', courseData);
            displayMessage('coursesData', result, 'success');
            hideAddCourseForm();
            loadCourses();
        }
        
        // Grade functions
        async function loadGrades() {
            const data = await apiCall('/api/grades');
            displayData('gradesData', data, 'Grades');
        }
        
        function showAddGradeForm() {
            document.getElementById('addGradeForm').style.display = 'block';
        }
        
        function hideAddGradeForm() {
            document.getElementById('addGradeForm').style.display = 'none';
        }
        
        async function addGrade() {
            const gradeData = {
                assignmentName: document.getElementById('gradeAssignmentName').value,
                assignmentType: document.getElementById('gradeAssignmentType').value,
                score: parseFloat(document.getElementById('gradeScore').value),
                maxScore: parseFloat(document.getElementById('gradeMaxScore').value),
                comments: document.getElementById('gradeComments').value
            };
            
            const result = await apiCall('/api/grades', 'POST', gradeData);
            displayMessage('gradesData', result, 'success');
            hideAddGradeForm();
            loadGrades();
        }
        
        // Attendance functions
        async function loadAttendance() {
            const data = await apiCall('/api/attendance');
            displayData('attendanceData', data, 'Attendance Records');
        }
        
        function showAddAttendanceForm() {
            document.getElementById('addAttendanceForm').style.display = 'block';
            document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
        }
        
        function hideAddAttendanceForm() {
            document.getElementById('addAttendanceForm').style.display = 'none';
        }
        
        async function addAttendance() {
            const attendanceData = {
                date: document.getElementById('attendanceDate').value,
                status: document.getElementById('attendanceStatus').value,
                notes: document.getElementById('attendanceNotes').value
            };
            
            const result = await apiCall('/api/attendance', 'POST', attendanceData);
            displayMessage('attendanceData', result, 'success');
            hideAddAttendanceForm();
            loadAttendance();
        }
        
        async function quickCheckIn() {
            const attendanceData = {
                notes: 'Quick check-in from dashboard'
            };
            
            const result = await apiCall('/api/attendance/checkin', 'POST', attendanceData);
            displayMessage('attendanceData', result, 'success');
            loadAttendance();
        }

        // MongoDB Info function
        function showMongoInfo() {
            alert('Connected to MongoDB Atlas Cloud Database\nDatabase: brelinx_edusuite\nData is persistent and secure!');
        }
        
        // Load initial data when page loads
        window.addEventListener('load', function() {
            loadDashboardData();
        });
    </script>
</body>
</html>